{
  "description": "Coastal Zones change 2012-2018",
  "steps": [
    {
      "check_ident": "qc_tool.vector.unzip",
      "required": true
    },
    {
      "check_ident": "qc_tool.vector.naming",
      "required": true,
      "parameters": {
        "reference_year": "2018",
        "formats": [".gdb", ".gpkg"],
        "layer_names": {
          "change": "^cz_change_2012_2018_(?P<aoi_code>[a-z0-9]+)_3035_"
        },
        "excessive_layers_allowed": false,
        "boundary_source": "boundary_cz.shp"
      }
    },
    {
      "check_ident": "qc_tool.vector.attribute",
      "required": true,
      "parameters": {
        "layers": ["change"],
        "required": {"id": "integer",
                     "du": "string",
                     "code_1_12": "integer",
                     "code_2_12": "integer",
                     "code_3_12": "integer",
                     "code_4_12": "integer",
                     "code_5_12": "integer",
                     "nodata_12": "integer",
                     "code_1_18": "integer",
                     "code_2_18": "integer",
                     "code_3_18": "integer",
                     "code_4_18": "integer",
                     "code_5_18": "integer",
                     "nodata_18": "integer",
                     "comment": "string",
                     "changecode": "string",
                     "area_ha": "real"},
        "ignored": ["shape_area", "shape_length"]
      }
    },
    {
      "check_ident": "qc_tool.vector.epsg",
      "required": true,
      "parameters": {
        "layers": ["change"],
        "epsg": 3035,
        "auto_identify_epsg": false
      }
    },
    {
      "check_ident": "qc_tool.vector.import2pg",
      "required": true
    },
    {
      "check_ident": "qc_tool.vector.inspire",
      "required": false,
      "parameters": {
        "layers": ["change"]
      }
    },
    {
      "check_ident": "qc_tool.vector.unique",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "unique_keys": ["id"]
      }
    },
    {
      "check_ident": "qc_tool.vector.enum",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "column_defs": [["nodata_12", [0,
                                       1]],
                        ["code_1_12", [0,
                                       1,
                                       2,
                                       3,
                                       4,
                                       5,
                                       6,
                                       7,
                                       8]],
                        ["code_2_12", [0,
                                       11,
                                       12,
                                       13,
                                       14,
                                       21,
                                       22,
                                       23,
                                       31,
                                       32,
                                       33,
                                       34,
                                       35,
                                       36,
                                       41,
                                       42,
                                       51,
                                       52,
                                       53,
                                       61,
                                       62,
                                       63,
                                       71,
                                       72,
                                       81,
                                       82,
                                       83,
                                       84]],
                        ["code_3_12", [0,
                                       111,
                                       112,
                                       121,
                                       122,
                                       123,
                                       124,
                                       131,
                                       132,
                                       140,
                                       211,
                                       212,
                                       221,
                                       222,
                                       231,
                                       232,
                                       233,
                                       234,
                                       311,
                                       312,
                                       321,
                                       322,
                                       331,
                                       332,
                                       340,
                                       350,
                                       360,
                                       410,
                                       421,
                                       422,
                                       510,
                                       520,
                                       530,
                                       611,
                                       612,
                                       621,
                                       622,
                                       631,
                                       632,
                                       633,
                                       711,
                                       712,
                                       721,
                                       722,
                                       723,
                                       811,
                                       812,
                                       813,
                                       821,
                                       822,
                                       823,
                                       824,
                                       831,
                                       832,
                                       833,
                                       841,
                                       842]],
                        ["code_4_12", [0,
                                       1111,
                                       1112,
                                       1113,
                                       1121,
                                       1122,
                                       1210,
                                       1220,
                                       1231,
                                       1232,
                                       1233,
                                       1234,
                                       1235,
                                       1236,
                                       1237,
                                       1240,
                                       1311,
                                       1312,
                                       1313,
                                       1320,
                                       1400,
                                       2110,
                                       2120,
                                       2210,
                                       2220,
                                       2310,
                                       2320,
                                       2330,
                                       2340,
                                       3110,
                                       3120,
                                       3210,
                                       3220,
                                       3310,
                                       3320,
                                       3400,
                                       3500,
                                       3600,
                                       4100,
                                       4210,
                                       4220,
                                       5100,
                                       5200,
                                       5300,
                                       6110,
                                       6120,
                                       6211,
                                       6212,
                                       6220,
                                       6311,
                                       6312,
                                       6320,
                                       6330,
                                       7110,
                                       7121,
                                       7122,
                                       7210,
                                       7220,
                                       7230,
                                       8110,
                                       8120,
                                       8130,
                                       8210,
                                       8220,
                                       8230,
                                       8240,
                                       8310,
                                       8320,
                                       8330,
                                       8410,
                                       8420]],
                        ["code_5_12", [0,
                                       11120,
                                       11130,
                                       11210,
                                       11220,
                                       12100,
                                       12200,
                                       12310,
                                       12320,
                                       12330,
                                       12340,
                                       12350,
                                       12360,
                                       12370,
                                       12400,
                                       13110,
                                       13120,
                                       13130,
                                       13200,
                                       14000,
                                       21100,
                                       21200,
                                       22100,
                                       22200,
                                       23100,
                                       23200,
                                       23300,
                                       23400,
                                       31100,
                                       31200,
                                       32100,
                                       32200,
                                       33100,
                                       33200,
                                       34000,
                                       35000,
                                       36000,
                                       41000,
                                       42100,
                                       42200,
                                       51000,
                                       52000,
                                       53000,
                                       61100,
                                       61200,
                                       62111,
                                       62112,
                                       62120,
                                       62200,
                                       63110,
                                       63120,
                                       63200,
                                       63300,
                                       71100,
                                       71210,
                                       71220,
                                       72100,
                                       72200,
                                       72300,
                                       81100,
                                       81200,
                                       81300,
                                       82100,
                                       82200,
                                       82300,
                                       82400,
                                       83100,
                                       83200,
                                       83300,
                                       84100,
                                       84200]],
                        ["nodata_18", [0,
                                        1]],
                        ["code_1_18", [0,
                                       1,
                                       2,
                                       3,
                                       4,
                                       5,
                                       6,
                                       7,
                                       8]],
                        ["code_2_18", [0,
                                       11,
                                       12,
                                       13,
                                       14,
                                       21,
                                       22,
                                       23,
                                       31,
                                       32,
                                       33,
                                       34,
                                       35,
                                       36,
                                       41,
                                       42,
                                       51,
                                       52,
                                       53,
                                       61,
                                       62,
                                       63,
                                       71,
                                       72,
                                       81,
                                       82,
                                       83,
                                       84]],
                        ["code_3_18", [0,
                                       111,
                                       112,
                                       121,
                                       122,
                                       123,
                                       124,
                                       131,
                                       132,
                                       140,
                                       211,
                                       212,
                                       221,
                                       222,
                                       231,
                                       232,
                                       233,
                                       234,
                                       311,
                                       312,
                                       321,
                                       322,
                                       331,
                                       332,
                                       340,
                                       350,
                                       360,
                                       410,
                                       421,
                                       422,
                                       510,
                                       520,
                                       530,
                                       611,
                                       612,
                                       621,
                                       622,
                                       631,
                                       632,
                                       633,
                                       711,
                                       712,
                                       721,
                                       722,
                                       723,
                                       811,
                                       812,
                                       813,
                                       821,
                                       822,
                                       823,
                                       824,
                                       831,
                                       832,
                                       833,
                                       841,
                                       842]],
                        ["code_4_18", [0,
                                       1111,
                                       1112,
                                       1113,
                                       1121,
                                       1122,
                                       1210,
                                       1220,
                                       1231,
                                       1232,
                                       1233,
                                       1234,
                                       1235,
                                       1236,
                                       1237,
                                       1240,
                                       1311,
                                       1312,
                                       1313,
                                       1320,
                                       1400,
                                       2110,
                                       2120,
                                       2210,
                                       2220,
                                       2310,
                                       2320,
                                       2330,
                                       2340,
                                       3110,
                                       3120,
                                       3210,
                                       3220,
                                       3310,
                                       3320,
                                       3400,
                                       3500,
                                       3600,
                                       4100,
                                       4210,
                                       4220,
                                       5100,
                                       5200,
                                       5300,
                                       6110,
                                       6120,
                                       6211,
                                       6212,
                                       6220,
                                       6311,
                                       6312,
                                       6320,
                                       6330,
                                       7110,
                                       7121,
                                       7122,
                                       7210,
                                       7220,
                                       7230,
                                       8110,
                                       8120,
                                       8130,
                                       8210,
                                       8220,
                                       8230,
                                       8240,
                                       8310,
                                       8320,
                                       8330,
                                       8410,
                                       8420]],
                        ["code_5_18", [0,
                                       11120,
                                       11130,
                                       11210,
                                       11220,
                                       12100,
                                       12200,
                                       12310,
                                       12320,
                                       12330,
                                       12340,
                                       12350,
                                       12360,
                                       12370,
                                       12400,
                                       13110,
                                       13120,
                                       13130,
                                       13200,
                                       14000,
                                       21100,
                                       21200,
                                       22100,
                                       22200,
                                       23100,
                                       23200,
                                       23300,
                                       23400,
                                       31100,
                                       31200,
                                       32100,
                                       32200,
                                       33100,
                                       33200,
                                       34000,
                                       35000,
                                       36000,
                                       41000,
                                       42100,
                                       42200,
                                       51000,
                                       52000,
                                       53000,
                                       61100,
                                       61200,
                                       62111,
                                       62112,
                                       62120,
                                       62200,
                                       63110,
                                       63120,
                                       63200,
                                       63300,
                                       71100,
                                       71210,
                                       71220,
                                       72100,
                                       72200,
                                       72300,
                                       81100,
                                       81200,
                                       81300,
                                       82100,
                                       82200,
                                       82300,
                                       82400,
                                       83100,
                                       83200,
                                       83300,
                                       84100,
                                       84200]]]
      }
    },
    {
      "check_ident": "qc_tool.vector.change",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "initial_code_column_name": "code_5_12",
        "final_code_column_name": "code_5_18"
      }
    },
    {
      "check_ident": "qc_tool.vector.singlepart",
      "required": false,
      "parameters": {
        "layers": ["change"]
      }
    },
    {
      "check_ident": "qc_tool.vector.geometry",
      "required": false,
      "parameters": {
        "layers": ["change"]
      }
    },
    {
      "check_ident": "qc_tool.vector.area",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "area_column_name": "area_ha",
        "unit": 10000,
        "tolerance": 0.5
      }
    },
    {
      "check_ident": "qc_tool.vector.mmu",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "complex_change": {"initial_code_column_name": "code_5_12",
                           "final_code_column_name": "code_5_18",
                           "area_column_name": "area_ha"},
        "general_where": [" layer.area_ha >= 0.5"],
        "exception_where": [" (layer.code_4_12 IN (1210, 1220, 8110, 8120)",
                            "  AND EXISTS (SELECT FROM neighbours(meta.fid) WHERE code_4_12 IN (1210, 1220, 8110, 8120))",
                            "  AND layer.area_ha >= 0.1)",
                            "OR",
                            " (layer.code_1_12 = 1",
                            "  AND layer.code_4_12 NOT IN (1210, 1220, 8110, 8120)",
                            "  AND EXISTS (SELECT FROM neighbours(meta.fid) WHERE code_4_12 IN (1210, 1220))",
                            "  AND layer.area_ha >= 0.25)",
                            "OR",
                            " (meta.cc_area IS NOT NULL",
                            "  AND meta.cc_area >= 0.5",
                            "  AND layer.area_ha >= 0.05)",
                            "OR",
                            " (layer.comment IS NOT NULL",
                            "  AND has_comment(layer.comment, ARRAY['Area size exception (at Coastal Zones AoI boundary)',",
                            "                                       'Area size exception (inside Coastal Zones AoI boundary)',",
                            "                                       'Splitted change',",
                            "                                       'Areas related to change',",
                            "                                       'Flooded area 2012',",
                            "                                       'Different water level']))"],
        "warning_where": ["FALSE"]
      }
    },
    {
      "check_ident": "qc_tool.vector.mmw",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "mmw": 10.0,
        "general_where": "layer.code_4_18 NOT IN (1210, 1220, 8110, 8120)",
        "exception_where": "FALSE"
      }
    },
    {
      "check_ident": "qc_tool.vector.neighbour",
      "required": false,
      "parameters": {
        "layers": ["change"],
        "code_column_names": ["code_5_12", "code_5_18"],
        "exception_where": ["FALSE"],
        "error_where": ["TRUE"]
      }
    },
    {
      "check_ident": "qc_tool.vector.overlap",
      "required": false,
      "parameters": {
        "layers": ["change"]
      }
    }
  ]
}
